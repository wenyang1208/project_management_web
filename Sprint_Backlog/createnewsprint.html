<!DOCTYPE html>
<html>
<head>
  <title>Create new sprint</title>
  <link rel="stylesheet" href="createnewsprint.css">
</head>
<body>

  <div class="light-blue-frame">
    <div class="previous-page">
      <a href = "scrumboard.html"><img src="../Product_Backlog/previouspage.png" width=30px height = 30px></a>
  </div>

    <div class="sprint-frame flex col">
      <div class="sprint-name">
        <span class="text">Sprint name: </span>
        <input type="text" id="sprint" name="sprint" minlength="2">
      </div>
      <div class="sprintview">
        <div class="flex col">
          <div class="startdate">
              <label for="start-date">Start Date:</label>
            <input type="date" id="start-date" name="start-date">
          </div>
          <div class="enddate">
              <label for="end-date">End Date:</label>
            <input type="date" id="end-date" name="end-date">
          </div>

          <div class="status">
            <div class="statustitle">
              <label for="status">Status:</label> <br><br>
            </div>
            <div class = "statusoptions">
            <input type="radio" id="notstarted" name="check" value="Not Started">
            <label for="notstarted"> Not Started</label><br><br>
            <input type="radio" id="active" name="check" value="Active">
            <label for="active"> Active</label><br><br>
            <input type="radio" id="completed" name="check" value="Completed">
            <label for="completed"> Completed</label><br><br>
          </div>
          </div>
        
        </div>

      </div>
    </div>

 
    <br>
    <div class="button-container">
        <a href="scrumboard.html" id="save-button" class="save-button">Add new sprint</a>

        <a href="scrumboard.html" id="discard-button" class="discard-button">Discard</a>
    </div>
    

  </div>
<script type="module">
  // Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";
const firebaseConfig = {
    apiKey: "AIzaSyAk2H_8opCo31ebK1Ce_hZ5G36XNkydR1s",
    authDomain: "project-2782373696466964042.firebaseapp.com",
    databaseURL: "https://project-2782373696466964042-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "project-2782373696466964042",
    storageBucket: "project-2782373696466964042.appspot.com",
    messagingSenderId: "971400388443",
    appId: "1:971400388443:web:fc495758d4109f4a1f847e"
};
document.addEventListener("DOMContentLoaded",function(){
// Initialize Firebase
const app = initializeApp(firebaseConfig);

const db = getDatabase(app);

document.getElementById("save-button").addEventListener('click', function(e){
          
    e.preventDefault();

    const sprint = document.getElementById("sprint").value;
    const startDate = document.getElementById("start-date").value;
    const endDate = document.getElementById("end-date").value;

    // Create an empty array to store selected status options
    const selectedStatus = document.querySelector('input[type="radio"]:checked');

    if(sprint.length !== 0 && startDate.length !== 0 && endDate.length !== 0 && selectedStatus.value !== null){
        if(startDate <= endDate){
            set(ref(db, 'newsprint/' + document.getElementById("sprint").value),
            {
                sprint : sprint,
                startDate : startDate,
                endDate : endDate,
                selectedStatus : selectedStatus.value
            })
            .then(() => {window.location.href = "scrumboard.html"})  
        }else{
            alert("Start date must be smaller than or equal to the end date.")
        }
    }
    else{
        alert("Please enter all the sprint details.")
    }
  });
})

</script>
</body>
</html>